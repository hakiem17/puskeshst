<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Puskesmas Modern</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8fafc;
            color: #1e293b;
        }

        .admin-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 250px;
            background: linear-gradient(135deg, #1e293b, #334155);
            color: white;
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 0 20px 30px;
            border-bottom: 1px solid #475569;
        }

        .sidebar-header h2 {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .sidebar-header p {
            color: #94a3b8;
            font-size: 0.9rem;
        }

        .sidebar-menu {
            padding: 20px 0;
        }

        .menu-item {
            display: block;
            padding: 12px 20px;
            color: #cbd5e1;
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .menu-item:hover,
        .menu-item.active {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
            border-left-color: #3b82f6;
        }

        .menu-item i {
            margin-right: 10px;
            width: 20px;
        }

        /* Main Content */
        .main-content {
            margin-left: 250px;
            flex: 1;
            padding: 20px;
        }

        .admin-header {
            background: white;
            padding: 20px 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-header h1 {
            font-size: 2rem;
            color: #1e293b;
            margin-bottom: 10px;
        }

        .logout-btn {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(239, 68, 68, 0.3);
        }

        .admin-header p {
            color: #64748b;
        }

        /* Dashboard Cards */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.5rem;
        }

        .card-icon.blue {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }

        .card-icon.green {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .card-icon.orange {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .card-icon.red {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1e293b;
        }

        .card-value {
            font-size: 2rem;
            font-weight: bold;
            color: #1e293b;
            margin-bottom: 5px;
        }

        .card-description {
            color: #64748b;
            font-size: 0.9rem;
        }

        /* Content Management */
        .content-section {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .section-header {
            padding: 20px 30px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: between;
            align-items: center;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #1e293b;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .section-content {
            padding: 30px;
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-help {
            display: block;
            margin-top: 5px;
            font-size: 0.875rem;
            color: #6b7280;
        }

        /* Gallery Tabs */
        .gallery-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e5e7eb;
        }

        .tab-btn {
            padding: 12px 24px;
            border: none;
            background: transparent;
            color: #6b7280;
            font-weight: 500;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn:hover {
            color: #3b82f6;
            background: #f8fafc;
        }

        .tab-btn.active {
            color: #3b82f6;
            border-bottom-color: #3b82f6;
            background: #f8fafc;
        }

        .gallery-tab-content {
            display: none;
        }

        .gallery-tab-content.active {
            display: block;
        }

        .tab-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .tab-header h3 {
            font-size: 1.5rem;
            color: #1e293b;
            margin: 0;
        }

        /* Gallery Modal */
        .gallery-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .modal-content {
            background: white;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
        }

        .modal-header h3 {
            margin: 0;
            color: #1e293b;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6b7280;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            padding: 20px;
            border-top: 1px solid #e5e7eb;
        }

        /* Gallery Item Cards */
        .gallery-item-card {
            display: flex;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            overflow: hidden;
        }

        .gallery-item-image {
            width: 150px;
            height: 120px;
            flex-shrink: 0;
        }

        .gallery-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .gallery-item-content {
            flex: 1;
            padding: 20px;
        }

        .gallery-item-content h4 {
            margin: 0 0 10px 0;
            color: #1e293b;
            font-size: 1.1rem;
        }

        .gallery-item-content p {
            margin: 0 0 10px 0;
            color: #64748b;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .gallery-item-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 20px;
            align-items: flex-end;
        }

        .category-badge {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
        }

        .video-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.8rem;
            color: #64748b;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* Tables */
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .table th {
            background: #f8fafc;
            font-weight: 600;
            color: #374151;
        }

        .table tr:hover {
            background: #f8fafc;
        }

        /* Hidden sections */
        .content-section.hidden {
            display: none;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }
            
            .main-content {
                margin-left: 200px;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 640px) {
            .sidebar {
                width: 100%;
                position: relative;
                height: auto;
            }
            
            .main-content {
                margin-left: 0;
            }
        }

        /* Image Preview Styles */
        .image-preview {
            margin-top: 10px;
            padding: 10px;
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            text-align: center;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f9fafb;
        }

        .image-preview img {
            max-width: 200px;
            max-height: 150px;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .image-preview.empty {
            color: #6b7280;
            font-style: italic;
        }

        .upload-area {
            border: 2px dashed #3b82f6;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            background: #f0f9ff;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            background: #e0f2fe;
            border-color: #1d4ed8;
        }

        .upload-area.dragover {
            background: #dbeafe;
            border-color: #1d4ed8;
        }

        .gallery-preview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .gallery-preview img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .current-gallery-list {
            margin-top: 15px;
        }

        .gallery-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }

        .gallery-item:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
        }

        .gallery-item-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .gallery-item-thumbnail {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .gallery-item-details h4 {
            margin: 0;
            color: #1e293b;
            font-size: 14px;
            font-weight: 600;
        }

        .gallery-item-details p {
            margin: 4px 0 0 0;
            color: #64748b;
            font-size: 12px;
        }

        .gallery-item-actions {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .btn-edit {
            background: #3b82f6;
            color: white;
        }

        .btn-edit:hover {
            background: #2563eb;
        }

        .btn-delete {
            background: #ef4444;
            color: white;
        }

        .btn-delete:hover {
            background: #dc2626;
        }

        .gallery-preview img:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-cog"></i> Admin Panel</h2>
                <p>Puskesmas Modern</p>
            </div>
            <div class="sidebar-menu">
                <a href="#" class="menu-item active" onclick="showSection('dashboard')">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </a>
                <a href="#" class="menu-item" onclick="showSection('hero')">
                    <i class="fas fa-images"></i> Hero Section
                </a>
                <a href="#" class="menu-item" onclick="showSection('services')">
                    <i class="fas fa-concierge-bell"></i> Layanan
                </a>
                <a href="#" class="menu-item" onclick="showSection('gallery')">
                    <i class="fas fa-photo-video"></i> Gallery
                </a>
                <a href="#" class="menu-item" onclick="showSection('about')">
                    <i class="fas fa-info-circle"></i> Tentang Kami
                </a>
                <a href="#" class="menu-item" onclick="showSection('contact')">
                    <i class="fas fa-phone"></i> Kontak
                </a>
                <a href="#" class="menu-item" onclick="showSection('settings')">
                    <i class="fas fa-cog"></i> Pengaturan
                </a>
                <a href="#" class="menu-item" onclick="showSection('pengaduan-content')">
                    <i class="fas fa-exclamation-triangle"></i> Konten Pengaduan
                </a>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section">
                <div class="admin-header">
                    <div>
                        <h1><i class="fas fa-tachometer-alt"></i> Dashboard</h1>
                        <p>Kelola konten website Puskesmas Modern</p>
                    </div>
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon blue">
                                <i class="fas fa-eye"></i>
                            </div>
                            <div>
                                <div class="card-title">Total Pengunjung</div>
                            </div>
                        </div>
                        <div class="card-value" id="totalVisitors">1,250</div>
                        <div class="card-description">Bulan ini</div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon green">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div>
                                <div class="card-title">Janji Temu</div>
                            </div>
                        </div>
                        <div class="card-value" id="totalAppointments">89</div>
                        <div class="card-description">Hari ini</div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon orange">
                                <i class="fas fa-users"></i>
                            </div>
                            <div>
                                <div class="card-title">Pasien</div>
                            </div>
                        </div>
                        <div class="card-value" id="totalPatients">1,250</div>
                        <div class="card-description">Total pasien</div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon red">
                                <i class="fas fa-user-md"></i>
                            </div>
                            <div>
                                <div class="card-title">Dokter</div>
                            </div>
                        </div>
                        <div class="card-value" id="totalDoctors">15</div>
                        <div class="card-description">Aktif</div>
                    </div>
                </div>
            </section>

            <!-- Hero Section Management -->
            <section id="hero" class="content-section hidden">
                <div class="section-header">
                    <h2 class="section-title"><i class="fas fa-images"></i> Kelola Hero Section</h2>
                    <button class="btn btn-primary" onclick="addHeroSlide()">
                        <i class="fas fa-plus"></i> Tambah Slide
                    </button>
                </div>
                <div class="section-content">
                    <div class="form-group">
                        <label class="form-label">Judul Hero</label>
                        <input type="text" class="form-input" id="heroTitle" value="Pelayanan Kesehatan Modern & Terpercaya">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Deskripsi Hero</label>
                        <textarea class="form-input form-textarea" id="heroDescription">Sistem manajemen kesehatan terintegrasi yang memudahkan akses pelayanan medis dengan teknologi terdepan untuk kesehatan masyarakat yang lebih baik.</textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Upload Gambar Slide 1</label>
                        <input type="file" class="form-input" id="heroSlide1File" accept="image/jpeg,image/jpg,image/png" onchange="previewImage(this, 'heroSlide1Preview')">
                        <div id="heroSlide1Preview" class="image-preview"></div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Upload Gambar Slide 2</label>
                        <input type="file" class="form-input" id="heroSlide2File" accept="image/jpeg,image/jpg,image/png" onchange="previewImage(this, 'heroSlide2Preview')">
                        <div id="heroSlide2Preview" class="image-preview"></div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Upload Gambar Slide 3</label>
                        <input type="file" class="form-input" id="heroSlide3File" accept="image/jpeg,image/jpg,image/png" onchange="previewImage(this, 'heroSlide3Preview')">
                        <div id="heroSlide3Preview" class="image-preview"></div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Upload Gambar Slide 4</label>
                        <input type="file" class="form-input" id="heroSlide4File" accept="image/jpeg,image/jpg,image/png" onchange="previewImage(this, 'heroSlide4Preview')">
                        <div id="heroSlide4Preview" class="image-preview"></div>
                    </div>
                    <div class="form-group">
                        <button class="btn btn-primary" onclick="previewHeroChanges()" style="margin-right: 10px;">
                            <i class="fas fa-eye"></i> Preview Perubahan
                        </button>
                        <button class="btn btn-success" onclick="saveHeroSettings()">
                            <i class="fas fa-save"></i> Simpan Perubahan
                        </button>
                    </div>
                </div>
            </section>

            <!-- Services Management -->
            <section id="services" class="content-section hidden">
                <div class="section-header">
                    <h2 class="section-title"><i class="fas fa-concierge-bell"></i> Kelola Layanan</h2>
                    <button class="btn btn-primary" onclick="addService()">
                        <i class="fas fa-plus"></i> Tambah Layanan
                    </button>
                </div>
                <div class="section-content">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Nama Layanan</th>
                                <th>Deskripsi</th>
                                <th>Icon</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="servicesTable">
                            <tr>
                                <td>Konsultasi Dokter</td>
                                <td>Konsultasi dengan dokter spesialis</td>
                                <td><i class="fas fa-user-md"></i></td>
                                <td>
                                    <button class="btn btn-primary" onclick="editService(1)">Edit</button>
                                    <button class="btn btn-danger" onclick="deleteService(1)">Hapus</button>
                                </td>
                            </tr>
                            <tr>
                                <td>Pemeriksaan Lab</td>
                                <td>Pemeriksaan laboratorium lengkap</td>
                                <td><i class="fas fa-flask"></i></td>
                                <td>
                                    <button class="btn btn-primary" onclick="editService(2)">Edit</button>
                                    <button class="btn btn-danger" onclick="deleteService(2)">Hapus</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Gallery Management -->
            <section id="gallery" class="content-section hidden">
                <div class="section-header">
                    <h2 class="section-title"><i class="fas fa-photo-video"></i> Kelola Gallery</h2>
                </div>
                <div class="section-content">
                    <!-- Gallery Tabs -->
                    <div class="gallery-tabs">
                        <button class="tab-btn active" onclick="showGalleryTab('infografis')">
                            <i class="fas fa-chart-bar"></i> Infografis
                        </button>
                        <button class="tab-btn" onclick="showGalleryTab('video')">
                            <i class="fas fa-play-circle"></i> Video
                        </button>
                        <button class="tab-btn" onclick="showGalleryTab('berita')">
                            <i class="fas fa-newspaper"></i> Berita
                        </button>
                    </div>

                    <!-- Infografis Tab -->
                    <div id="infografis-tab" class="gallery-tab-content active">
                        <div class="tab-header">
                            <h3>Kelola Infografis</h3>
                            <button class="btn btn-primary" onclick="addInfografis()">
                                <i class="fas fa-plus"></i> Tambah Infografis
                            </button>
                        </div>
                        <div class="infografis-list" id="infografisList">
                            <!-- Infografis items will be loaded here -->
                        </div>
                    </div>

                    <!-- Video Tab -->
                    <div id="video-tab" class="gallery-tab-content">
                        <div class="tab-header">
                            <h3>Kelola Video</h3>
                            <button class="btn btn-primary" onclick="addVideo()">
                                <i class="fas fa-plus"></i> Tambah Video
                            </button>
                        </div>
                        <div class="video-list" id="videoList">
                            <!-- Video items will be loaded here -->
                        </div>
                    </div>

                    <!-- Berita Tab -->
                    <div id="berita-tab" class="gallery-tab-content">
                        <div class="tab-header">
                            <h3>Kelola Berita</h3>
                            <button class="btn btn-primary" onclick="addBerita()">
                                <i class="fas fa-plus"></i> Tambah Berita
                            </button>
                        </div>
                        <div class="berita-list" id="beritaList">
                            <!-- Berita items will be loaded here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- About Management -->
            <section id="about" class="content-section hidden">
                <div class="section-header">
                    <h2 class="section-title"><i class="fas fa-info-circle"></i> Kelola Tentang Kami</h2>
                </div>
                <div class="section-content">
                    <div class="form-group">
                        <label class="form-label">Judul Section</label>
                        <input type="text" id="aboutTitle" class="form-input" value="TENTANG KAMI">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Deskripsi</label>
                        <textarea id="aboutDescription" class="form-input form-textarea">Puskesmas Modern adalah pusat pelayanan kesehatan terdepan yang menyediakan layanan medis berkualitas tinggi dengan teknologi modern dan tenaga medis profesional.</textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Visi</label>
                        <textarea id="aboutVision" class="form-input form-textarea">Menjadi pusat pelayanan kesehatan terdepan yang memberikan pelayanan medis berkualitas tinggi untuk masyarakat.</textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Misi</label>
                        <textarea id="aboutMission" class="form-input form-textarea">1. Menyediakan pelayanan medis berkualitas tinggi\n2. Menggunakan teknologi modern dalam pelayanan\n3. Memberikan pelayanan yang ramah dan profesional\n4. Meningkatkan kesehatan masyarakat</textarea>
                    </div>
                    <button class="btn btn-success" onclick="saveAboutSettings()">
                        <i class="fas fa-save"></i> Simpan Perubahan
                    </button>
                </div>
            </section>

            <!-- Contact Management -->
            <section id="contact" class="content-section hidden">
                <div class="section-header">
                    <h2 class="section-title"><i class="fas fa-phone"></i> Kelola Kontak</h2>
                </div>
                <div class="section-content">
                    <div class="form-group">
                        <label class="form-label">Alamat</label>
                        <textarea id="contactAddress" class="form-input form-textarea">Jl. Kesehatan No. 123, Jakarta Pusat 10110</textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Telepon</label>
                        <input type="tel" id="contactPhone" class="form-input" value="(021) 1234-5678">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" id="contactEmail" class="form-input" value="info@puskesmasmodern.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Jam Operasional</label>
                        <input type="text" id="contactHours" class="form-input" value="Senin - Jumat: 08:00 - 17:00">
                    </div>
                    <button class="btn btn-success" onclick="saveContactSettings()">
                        <i class="fas fa-save"></i> Simpan Perubahan
                    </button>
                </div>
            </section>

            <!-- Settings -->
            <section id="settings" class="content-section hidden">
                <div class="section-header">
                    <h2 class="section-title"><i class="fas fa-cog"></i> Pengaturan Website</h2>
                </div>
                <div class="section-content">
                    <div class="form-group">
                        <label class="form-label">Nama Website</label>
                        <input type="text" id="websiteName" class="form-input" value="Puskesmas Modern">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Logo URL</label>
                        <input type="url" id="websiteLogo" class="form-input" placeholder="https://example.com/logo.png">
                        <small class="form-help">Kosongkan untuk menggunakan logo default (icon + teks)</small>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Favicon URL</label>
                        <input type="url" id="websiteFavicon" class="form-input" placeholder="https://example.com/favicon.ico">
                        <small class="form-help">Kosongkan untuk menggunakan favicon default</small>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Meta Description</label>
                        <textarea id="websiteDescription" class="form-input form-textarea">Puskesmas Modern - Pelayanan kesehatan terdepan dengan teknologi modern dan tenaga medis profesional.</textarea>
                    </div>
                    <button class="btn btn-success" onclick="saveWebsiteSettings()">
                        <i class="fas fa-save"></i> Simpan Pengaturan
                    </button>
                </div>
            </section>

            <!-- Pengaduan Content Management -->
            <section id="pengaduan-content" class="content-section hidden">
                <div class="section-header">
                    <h2 class="section-title"><i class="fas fa-exclamation-triangle"></i> Kelola Konten Halaman Pengaduan</h2>
                </div>
                <div class="section-content">
                    <div class="form-group">
                        <label class="form-label">Upload Gambar</label>
                        <input type="file" id="pengaduanImage" class="form-input" accept="image/*">
                        <small class="form-help">Upload gambar untuk halaman pengaduan (JPG, PNG, GIF)</small>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Teks Utama</label>
                        <input type="text" id="pengaduanMainText" class="form-input" placeholder="Contoh: WAKTU PENYELESAIAN">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Keterangan 1</label>
                        <textarea id="pengaduanDesc1" class="form-input" rows="3" placeholder="Keterangan pertama..."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Keterangan 2</label>
                        <textarea id="pengaduanDesc2" class="form-input" rows="3" placeholder="Keterangan kedua..."></textarea>
                    </div>
                    <button class="btn btn-success" onclick="savePengaduanContent()">
                        <i class="fas fa-save"></i> Simpan Konten
                    </button>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Show specific section
        function showSection(sectionId) {
            // Hide all sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => section.classList.add('hidden'));
            
            // Show selected section
            document.getElementById(sectionId).classList.remove('hidden');
            
            // Update active menu item
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => item.classList.remove('active'));
            event.target.classList.add('active');
        }

        // Load dashboard data
        async function loadDashboardData() {
            try {
                const response = await fetch('/api/admin/dashboard');
                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('totalVisitors').textContent = data.data.totalPatients.toLocaleString();
                    document.getElementById('totalAppointments').textContent = data.data.totalAppointments;
                    document.getElementById('totalPatients').textContent = data.data.totalPatients.toLocaleString();
                    document.getElementById('totalDoctors').textContent = data.data.totalDoctors;
                }
            } catch (error) {
                console.error('Error loading dashboard data:', error);
            }
        }

        // Image preview function
        function previewImage(input, previewId) {
            const preview = document.getElementById(previewId);
            const file = input.files[0];
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
                };
                reader.readAsDataURL(file);
            } else {
                preview.innerHTML = '<p class="empty">Belum ada gambar dipilih</p>';
            }
        }

        // Gallery preview function
        function previewGalleryImages(input) {
            const preview = document.getElementById('galleryPreview');
            const files = input.files;
            
            preview.innerHTML = '';
            
            if (files.length > 0) {
                Array.from(files).forEach((file, index) => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        img.alt = `Gallery ${index + 1}`;
                        img.style.cssText = 'width: 100%; height: 120px; object-fit: cover; border-radius: 8px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);';
                        preview.appendChild(img);
                    };
                    reader.readAsDataURL(file);
                });
            } else {
                preview.innerHTML = '<p class="empty">Belum ada gambar dipilih</p>';
            }
        }

        // Save functions
        function saveHeroSettings() {
            // Get form values
            const heroTitle = document.getElementById('heroTitle').value;
            const heroDescription = document.getElementById('heroDescription').value;
            
            // Get uploaded files
            const slide1File = document.getElementById('heroSlide1File').files[0];
            const slide2File = document.getElementById('heroSlide2File').files[0];
            const slide3File = document.getElementById('heroSlide3File').files[0];
            const slide4File = document.getElementById('heroSlide4File').files[0];
            
            // Check if at least one file is uploaded
            const files = [slide1File, slide2File, slide3File, slide4File];
            const hasFiles = files.some(file => file !== undefined);
            
            // If no files uploaded, save text only but preserve existing slides
            if (!hasFiles) {
                const existingSettings = JSON.parse(localStorage.getItem('heroSettings') || '{"slides": []}');
                const heroData = {
                    title: heroTitle,
                    description: heroDescription,
                    slides: existingSettings.slides || [],
                    timestamp: new Date().toISOString()
                };
                
                localStorage.setItem('heroSettings', JSON.stringify(heroData));
                
                // Send to server
                fetch('/api/admin/hero', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(heroData)
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('Pengaturan Hero Section berhasil disimpan!');
                        window.open('/', '_blank');
                    } else {
                        alert('Error: ' + data.message);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Pengaturan Hero Section berhasil disimpan di browser!');
                });
                return;
            }
            
            // Get existing slides from localStorage to preserve them
            const existingSettings = JSON.parse(localStorage.getItem('heroSettings') || '{"slides": []}');
            const existingSlides = existingSettings.slides || [];
            
            // Convert files to base64
            const slides = [...existingSlides]; // Start with existing slides
            let processedFiles = 0;
            const totalFiles = files.filter(f => f).length;
            
            files.forEach((file, index) => {
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        slides[index] = e.target.result; // Update only the slide with new file
                        processedFiles++;
                        
                        // Save when all files are processed
                        if (processedFiles === totalFiles) {
                            // Save to localStorage
                            const heroData = {
                                title: heroTitle,
                                description: heroDescription,
                                slides: slides,
                                timestamp: new Date().toISOString()
                            };
                            
                            localStorage.setItem('heroSettings', JSON.stringify(heroData));
                            
                            // Send to server
                            fetch('/api/admin/hero', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify(heroData)
                            })
                            .then(response => response.json())
                            .then(data => {
                                if (data.success) {
                                    alert('Pengaturan Hero Section berhasil disimpan!');
                                    // Update main website immediately
                                    updateMainWebsite(heroData);
                                    // Open main website in new tab to see changes
                                    window.open('/', '_blank');
                                } else {
                                    alert('Error: ' + data.message);
                                }
                            })
                            .catch(error => {
                                console.error('Error:', error);
                                alert('Pengaturan Hero Section berhasil disimpan di browser!');
                            });
                        }
                    };
                    reader.readAsDataURL(file);
                }
            });
        }
        
        // Load hero settings from localStorage
        function loadHeroSettings() {
            const savedSettings = localStorage.getItem('heroSettings');
            if (savedSettings) {
                const data = JSON.parse(savedSettings);
                document.getElementById('heroTitle').value = data.title || '';
                document.getElementById('heroDescription').value = data.description || '';
                
                // Show saved images in preview
                if (data.slides) {
                    data.slides.forEach((slide, index) => {
                        if (slide) {
                            const previewId = `heroSlide${index + 1}Preview`;
                            const preview = document.getElementById(previewId);
                            if (preview) {
                                preview.innerHTML = `<img src="${slide}" alt="Preview">`;
                            }
                        }
                    });
                }
            }
        }

        function loadGallerySettings() {
            const savedGallery = localStorage.getItem('gallerySettings');
            if (savedGallery) {
                try {
                    const data = JSON.parse(savedGallery);
                    
                    // Update gallery preview
                    if (data.images && data.images.length > 0) {
                        const galleryPreview = document.getElementById('galleryPreview');
                        if (galleryPreview) {
                            galleryPreview.innerHTML = '';
                            data.images.forEach((image, index) => {
                                const img = document.createElement('img');
                                img.src = image;
                                img.style.cssText = 'width: 100%; height: 120px; object-fit: cover; border-radius: 8px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);';
                                galleryPreview.appendChild(img);
                            });
                        }
                    }

                    // Update current gallery list
                    displayCurrentGallery(data.images || []);
                } catch (error) {
                    console.log('Error loading gallery settings:', error);
                }
            } else {
                displayCurrentGallery([]);
            }
        }

        // Load about settings from localStorage
        function loadAboutSettings() {
            const savedSettings = localStorage.getItem('aboutSettings');
            if (savedSettings) {
                try {
                    const data = JSON.parse(savedSettings);
                    
                    // Update form fields
                    if (data.title) document.getElementById('aboutTitle').value = data.title;
                    if (data.description) document.getElementById('aboutDescription').value = data.description;
                    if (data.vision) document.getElementById('aboutVision').value = data.vision;
                    if (data.mission) document.getElementById('aboutMission').value = data.mission;
                } catch (error) {
                    console.log('Error loading about settings:', error);
                }
            }
        }

        function displayCurrentGallery(images) {
            const currentGalleryList = document.getElementById('currentGalleryList');
            
            if (!images || images.length === 0) {
                currentGalleryList.innerHTML = '<p style="color: #6b7280; font-style: italic;">Belum ada gambar gallery</p>';
                return;
            }

            currentGalleryList.innerHTML = '';
            
            images.forEach((image, index) => {
                const galleryItem = document.createElement('div');
                galleryItem.className = 'gallery-item';
                galleryItem.innerHTML = `
                    <div class="gallery-item-info">
                        <img src="${image}" alt="Gallery ${index + 1}" class="gallery-item-thumbnail">
                        <div class="gallery-item-details">
                            <h4>Gambar ${index + 1}</h4>
                            <p>Gallery Image</p>
                        </div>
                    </div>
                    <div class="gallery-item-actions">
                        <button class="btn-small btn-edit" onclick="editGalleryImage(${index})">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn-small btn-delete" onclick="deleteGalleryImage(${index})">
                            <i class="fas fa-trash"></i> Hapus
                        </button>
                    </div>
                `;
                currentGalleryList.appendChild(galleryItem);
            });
        }

        function editGalleryImage(index) {
            // Create file input for editing
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/jpeg,image/jpg,image/png';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const savedGallery = JSON.parse(localStorage.getItem('gallerySettings') || '{"images": []}');
                        savedGallery.images[index] = e.target.result;
                        localStorage.setItem('gallerySettings', JSON.stringify(savedGallery));
                        
                        // Update display
                        displayCurrentGallery(savedGallery.images);
                        loadGallerySettings();
                        
                        // Update main website
                        updateMainWebsiteGallery(savedGallery);
                        
                        alert('Gambar berhasil diupdate!');
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }

        function deleteGalleryImage(index) {
            if (confirm('Apakah Anda yakin ingin menghapus gambar ini?')) {
                const savedGallery = JSON.parse(localStorage.getItem('gallerySettings') || '{"images": []}');
                savedGallery.images.splice(index, 1);
                localStorage.setItem('gallerySettings', JSON.stringify(savedGallery));
                
                // Update display
                displayCurrentGallery(savedGallery.images);
                loadGallerySettings();
                
                // Update main website
                updateMainWebsiteGallery(savedGallery);
                
                alert('Gambar berhasil dihapus!');
            }
        }
        
        // Preview hero changes in real-time
        function previewHeroChanges() {
            const heroTitle = document.getElementById('heroTitle').value;
            const heroDescription = document.getElementById('heroDescription').value;
            
            // Get uploaded files and convert to base64
            const slide1File = document.getElementById('heroSlide1File').files[0];
            const slide2File = document.getElementById('heroSlide2File').files[0];
            const slide3File = document.getElementById('heroSlide3File').files[0];
            const slide4File = document.getElementById('heroSlide4File').files[0];
            
            const files = [slide1File, slide2File, slide3File, slide4File];
            const slideUrls = [];
            
            let processedFiles = 0;
            const totalFiles = files.filter(f => f).length;
            
            // Open preview window immediately
            const previewWindow = window.open('/', '_blank');
            if (previewWindow) {
                previewWindow.addEventListener('load', function() {
                    // Update hero content
                    const heroContent = previewWindow.document.querySelector('.hero-content h1');
                    const heroDesc = previewWindow.document.querySelector('.hero-content p');
                    
                    if (heroContent) heroContent.textContent = heroTitle;
                    if (heroDesc) heroDesc.textContent = heroDescription;
                    
                    // Update hero slides if files are uploaded
                    if (totalFiles > 0) {
                        const slides = previewWindow.document.querySelectorAll('.hero-slide');
                        slides.forEach((slide, index) => {
                            if (slideUrls[index]) {
                                slide.style.backgroundImage = `url('${slideUrls[index]}')`;
                            }
                        });
                    }
                });
            }
            
            // Process files if any
            if (totalFiles > 0) {
                files.forEach((file, index) => {
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            slideUrls[index] = e.target.result;
                            processedFiles++;
                            
                            if (processedFiles === totalFiles) {
                                // All files processed, update slides
                                if (previewWindow) {
                                    const slides = previewWindow.document.querySelectorAll('.hero-slide');
                                    slides.forEach((slide, index) => {
                                        if (slideUrls[index]) {
                                            slide.style.backgroundImage = `url('${slideUrls[index]}')`;
                                        }
                                    });
                                }
                            }
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
        }

        function saveGallerySettings() {
            const galleryFiles = document.getElementById('galleryFiles').files;
            
            if (galleryFiles.length === 0) {
                alert('Silakan pilih minimal 1 gambar untuk gallery!');
                return;
            }
            
            // Get existing gallery images
            const existingGallery = JSON.parse(localStorage.getItem('gallerySettings') || '{"images": []}');
            const existingImages = existingGallery.images || [];
            
            // Check if adding new images would exceed limit
            if (existingImages.length + galleryFiles.length > 10) {
                alert('Maksimal 10 gambar untuk gallery! Saat ini ada ' + existingImages.length + ' gambar.');
                return;
            }
            
            // Convert files to base64
            const newGalleryImages = [];
            let processedFiles = 0;
            
            Array.from(galleryFiles).forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    newGalleryImages[index] = e.target.result;
                    processedFiles++;
                    
                    if (processedFiles === galleryFiles.length) {
                        // Combine existing and new images
                        const combinedImages = [...existingImages, ...newGalleryImages];
                        
                        // Save to localStorage
                        const galleryData = {
                            images: combinedImages,
                            timestamp: new Date().toISOString()
                        };
                        
                        localStorage.setItem('gallerySettings', JSON.stringify(galleryData));
                        
                        // Send to server
                        fetch('/api/admin/gallery', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(galleryData)
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.success) {
                                alert('Gallery berhasil disimpan!');
                                displayCurrentGallery(combinedImages);
                                updateMainWebsiteGallery(galleryData); // Update main website immediately
                                window.open('/', '_blank');
                            } else {
                                alert('Error: ' + data.message);
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            alert('Gallery berhasil disimpan di browser!');
                        });
                    }
                };
                reader.readAsDataURL(file);
            });
        }

        function saveAboutSettings() {
            // Get form values
            const aboutData = {
                title: document.getElementById('aboutTitle').value,
                description: document.getElementById('aboutDescription').value,
                vision: document.getElementById('aboutVision').value,
                mission: document.getElementById('aboutMission').value,
                timestamp: new Date().toISOString()
            };
            
            // Save to localStorage
            localStorage.setItem('aboutSettings', JSON.stringify(aboutData));
            
            // Send to server
            fetch('/api/admin/about', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(aboutData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Pengaturan Tentang Kami berhasil disimpan!');
                    // Update main website immediately
                    updateMainWebsiteAbout(aboutData);
                    // Open main website in new tab to see changes
                    window.open('/', '_blank');
                } else {
                    alert('Error: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Pengaturan Tentang Kami berhasil disimpan di browser!');
            });
        }

        // Update main website with new hero data
        function updateMainWebsite(heroData) {
            // Try to update the main website if it's open
            try {
                // Check if main website is open in another tab
                const mainWindow = window.open('', '_blank');
                if (mainWindow) {
                    mainWindow.location.href = '/';
                    mainWindow.addEventListener('load', function() {
                        // Update hero content
                        const heroContent = mainWindow.document.querySelector('.hero-content h1');
                        const heroDesc = mainWindow.document.querySelector('.hero-content p');
                        
                        if (heroContent) heroContent.textContent = heroData.title;
                        if (heroDesc) heroDesc.textContent = heroData.description;
                        
                        // Update hero slides
                        const slides = mainWindow.document.querySelectorAll('.hero-slide');
                        slides.forEach((slide, index) => {
                            if (heroData.slides[index]) {
                                slide.style.backgroundImage = `url('${heroData.slides[index]}')`;
                            }
                        });
                    });
                }
            } catch (error) {
                console.log('Could not update main website:', error);
            }
        }

        // Update main website gallery
        function updateMainWebsiteGallery(galleryData) {
            try {
                const mainWindow = window.open('', '_blank');
                if (mainWindow) {
                    mainWindow.location.href = '/';
                    mainWindow.addEventListener('load', function() {
                        // Update gallery images
                        const galleryCards = mainWindow.document.querySelectorAll('.gallery-card');
                        galleryCards.forEach((card, index) => {
                            if (galleryData.images[index]) {
                                const img = card.querySelector('img');
                                if (img) {
                                    img.src = galleryData.images[index];
                                }
                            }
                        });
                    });
                }
            } catch (error) {
                console.log('Could not update main website gallery:', error);
            }
        }

        // Update main website about section
        function updateMainWebsiteAbout(aboutData) {
            try {
                const mainWindow = window.open('', '_blank');
                if (mainWindow) {
                    mainWindow.location.href = '/';
                    mainWindow.addEventListener('load', function() {
                        // Update about section content
                        const aboutTitle = mainWindow.document.querySelector('.about-section h2');
                        const aboutDescription = mainWindow.document.querySelector('.about-description');
                        const aboutVision = mainWindow.document.querySelector('.vision-content');
                        const aboutMission = mainWindow.document.querySelector('.mission-content');
                        
                        if (aboutTitle) aboutTitle.textContent = aboutData.title;
                        if (aboutDescription) aboutDescription.textContent = aboutData.description;
                        if (aboutVision) aboutVision.textContent = aboutData.vision;
                        if (aboutMission) aboutMission.textContent = aboutData.mission;
                    });
                }
            } catch (error) {
                console.log('Could not update main website about section:', error);
            }
        }

        // Update main website contact section
        function updateMainWebsiteContact(contactData) {
            try {
                const mainWindow = window.open('', '_blank');
                if (mainWindow) {
                    mainWindow.location.href = '/';
                    mainWindow.addEventListener('load', function() {
                        // Update contact section content
                        const contactAddress = mainWindow.document.querySelector('.contact-address');
                        const contactPhone = mainWindow.document.querySelector('.contact-phone');
                        const contactEmail = mainWindow.document.querySelector('.contact-email');
                        const contactHours = mainWindow.document.querySelector('.contact-hours');
                        
                        if (contactAddress) contactAddress.textContent = contactData.address;
                        if (contactPhone) contactPhone.textContent = contactData.phone;
                        if (contactEmail) contactEmail.textContent = contactData.email;
                        if (contactHours) contactHours.textContent = contactData.hours;
                    });
                }
            } catch (error) {
                console.log('Could not update main website contact section:', error);
            }
        }

        // Load contact settings from localStorage
        function loadContactSettings() {
            const savedSettings = localStorage.getItem('contactSettings');
            if (savedSettings) {
                try {
                    const data = JSON.parse(savedSettings);
                    
                    // Update form fields
                    if (data.address) document.getElementById('contactAddress').value = data.address;
                    if (data.phone) document.getElementById('contactPhone').value = data.phone;
                    if (data.email) document.getElementById('contactEmail').value = data.email;
                    if (data.hours) document.getElementById('contactHours').value = data.hours;
                } catch (error) {
                    console.log('Error loading contact settings:', error);
                }
            }
        }

        function saveContactSettings() {
            // Get form values
            const contactData = {
                address: document.getElementById('contactAddress').value,
                phone: document.getElementById('contactPhone').value,
                email: document.getElementById('contactEmail').value,
                hours: document.getElementById('contactHours').value,
                timestamp: new Date().toISOString()
            };
            
            // Save to localStorage
            localStorage.setItem('contactSettings', JSON.stringify(contactData));
            
            // Send to server
            fetch('/api/admin/contact', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(contactData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Pengaturan Kontak berhasil disimpan!');
                    // Update main website immediately
                    updateMainWebsiteContact(contactData);
                    // Open main website in new tab to see changes
                    window.open('/', '_blank');
                } else {
                    alert('Error: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Pengaturan Kontak berhasil disimpan di browser!');
            });
        }

        // Load website settings from localStorage
        function loadWebsiteSettings() {
            const savedSettings = localStorage.getItem('websiteSettings');
            if (savedSettings) {
                try {
                    const data = JSON.parse(savedSettings);
                    
                    // Update form fields
                    if (data.name) document.getElementById('websiteName').value = data.name;
                    if (data.logo) document.getElementById('websiteLogo').value = data.logo;
                    if (data.favicon) document.getElementById('websiteFavicon').value = data.favicon;
                    if (data.description) document.getElementById('websiteDescription').value = data.description;
                } catch (error) {
                    console.log('Error loading website settings:', error);
                }
            }
        }

        // Update main website settings
        function updateMainWebsiteSettings(websiteData) {
            try {
                const mainWindow = window.open('', '_blank');
                if (mainWindow) {
                    mainWindow.location.href = '/';
                    mainWindow.addEventListener('load', function() {
                        // Update website title
                        if (websiteData.name) {
                            mainWindow.document.title = websiteData.name;
                        }
                        
                        // Update logo
                        if (websiteData.logo) {
                            const logo = mainWindow.document.querySelector('.logo');
                            if (logo) {
                                // Create image element and test if it loads
                                const img = new Image();
                                img.onload = function() {
                                    logo.innerHTML = `<img src="${websiteData.logo}" alt="Logo" style="height: 40px; object-fit: contain;">`;
                                };
                                img.onerror = function() {
                                    // If image fails to load, keep the original logo
                                    console.log('Logo image failed to load, keeping original logo');
                                };
                                img.src = websiteData.logo;
                            }
                        }
                        
                        // Update favicon
                        if (websiteData.favicon) {
                            let favicon = mainWindow.document.querySelector('link[rel="icon"]');
                            if (!favicon) {
                                favicon = mainWindow.document.createElement('link');
                                favicon.rel = 'icon';
                                mainWindow.document.head.appendChild(favicon);
                            }
                            favicon.href = websiteData.favicon;
                        }
                        
                        // Update meta description
                        if (websiteData.description) {
                            let metaDesc = mainWindow.document.querySelector('meta[name="description"]');
                            if (!metaDesc) {
                                metaDesc = mainWindow.document.createElement('meta');
                                metaDesc.name = 'description';
                                mainWindow.document.head.appendChild(metaDesc);
                            }
                            metaDesc.content = websiteData.description;
                        }
                    });
                }
            } catch (error) {
                console.log('Could not update main website settings:', error);
            }
        }

        function saveWebsiteSettings() {
            // Get form values
            const websiteData = {
                name: document.getElementById('websiteName').value,
                logo: document.getElementById('websiteLogo').value,
                favicon: document.getElementById('websiteFavicon').value,
                description: document.getElementById('websiteDescription').value,
                timestamp: new Date().toISOString()
            };
            
            // Save to localStorage
            localStorage.setItem('websiteSettings', JSON.stringify(websiteData));
            
            // Send to server
            fetch('/api/admin/website', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(websiteData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Pengaturan Website berhasil disimpan!');
                    // Update main website immediately
                    updateMainWebsiteSettings(websiteData);
                    // Open main website in new tab to see changes
                    window.open('/', '_blank');
                } else {
                    alert('Error: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Pengaturan Website berhasil disimpan di browser!');
            });
        }

        // Pengaduan Content Management
        function savePengaduanContent() {
            const imageFile = document.getElementById('pengaduanImage').files[0];
            const mainText = document.getElementById('pengaduanMainText').value;
            const desc1 = document.getElementById('pengaduanDesc1').value;
            const desc2 = document.getElementById('pengaduanDesc2').value;

            if (!mainText || !desc1 || !desc2) {
                alert('Mohon lengkapi semua field!');
                return;
            }

            let imageData = null;
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imageData = e.target.result;
                    savePengaduanData(imageData, mainText, desc1, desc2);
                };
                reader.readAsDataURL(imageFile);
            } else {
                savePengaduanData(imageData, mainText, desc1, desc2);
            }
        }

        function savePengaduanData(imageData, mainText, desc1, desc2) {
            const pengaduanData = {
                image: imageData,
                mainText: mainText,
                desc1: desc1,
                desc2: desc2
            };

            // Save to localStorage
            localStorage.setItem('pengaduanContent', JSON.stringify(pengaduanData));
            
            // Update main website
            updateMainWebsitePengaduan(pengaduanData);
            
            alert('Konten pengaduan berhasil disimpan!');
        }

        function loadPengaduanContent() {
            const savedData = localStorage.getItem('pengaduanContent');
            if (savedData) {
                const data = JSON.parse(savedData);
                document.getElementById('pengaduanMainText').value = data.mainText || '';
                document.getElementById('pengaduanDesc1').value = data.desc1 || '';
                document.getElementById('pengaduanDesc2').value = data.desc2 || '';
            }
        }

        function updateMainWebsitePengaduan(data) {
            // Update halaman jangka-waktu-penyelesaian
            if (data.image) {
                // Update gambar jika ada
                console.log('Gambar pengaduan diupdate');
            }
            
            if (data.mainText) {
                // Update teks utama
                console.log('Teks utama diupdate:', data.mainText);
            }
            
            if (data.desc1 && data.desc2) {
                // Update keterangan
                console.log('Keterangan diupdate');
            }
        }

        // Add functions
        function addHeroSlide() {
            alert('Fitur tambah slide akan segera tersedia!');
        }

        function addService() {
            alert('Fitur tambah layanan akan segera tersedia!');
        }

        // Gallery Tab Management
        function showGalleryTab(tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.gallery-tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Remove active class from all buttons
            const buttons = document.querySelectorAll('.tab-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
            
            // Load data for the tab
            loadGalleryData(tabName);
        }

        function loadGalleryData(type) {
            const data = JSON.parse(localStorage.getItem(type + 'Data') || '[]');
            const container = document.getElementById(type + 'List');
            
            if (data.length === 0) {
                container.innerHTML = `<p style="color: #6b7280; font-style: italic; text-align: center; padding: 40px;">Belum ada ${type} yang ditambahkan</p>`;
                return;
            }
            
            container.innerHTML = data.map((item, index) => `
                <div class="gallery-item-card">
                    <div class="gallery-item-image">
                        <img src="${item.image || item.thumbnail}" alt="${item.title}">
                    </div>
                    <div class="gallery-item-content">
                        <h4>${item.title}</h4>
                        <p>${item.description}</p>
                        ${type === 'video' ? `<div class="video-meta"><span><i class="fas fa-clock"></i> ${item.duration}</span></div>` : ''}
                        ${type === 'konten' ? `<div class="konten-meta"><span class="category-badge">${item.category}</span></div>` : ''}
                    </div>
                    <div class="gallery-item-actions">
                        <button class="btn btn-primary" onclick="editGalleryItem('${type}', ${index})">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-danger" onclick="deleteGalleryItem('${type}', ${index})">
                            <i class="fas fa-trash"></i> Hapus
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function addInfografis() {
            showGalleryModal('infografis');
        }

        function addVideo() {
            showGalleryModal('video');
        }

        function addBerita() {
            showGalleryModal('berita');
        }

        function showGalleryModal(type) {
            const modal = document.createElement('div');
            modal.className = 'gallery-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Tambah ${type.charAt(0).toUpperCase() + type.slice(1)}</h3>
                        <button class="close-btn" onclick="closeGalleryModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label class="form-label">Judul</label>
                            <input type="text" id="galleryTitle" class="form-input" placeholder="Masukkan judul">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Deskripsi</label>
                            <textarea id="galleryDescription" class="form-input form-textarea" placeholder="Masukkan deskripsi"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Gambar/Thumbnail</label>
                            <input type="file" id="galleryImage" class="form-input" accept="image/*">
                        </div>
                        ${type === 'video' ? `
                            <div class="form-group">
                                <label class="form-label">URL Video</label>
                                <input type="url" id="videoUrl" class="form-input" placeholder="https://youtube.com/watch?v=...">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Durasi</label>
                                <input type="text" id="videoDuration" class="form-input" placeholder="3:45">
                            </div>
                        ` : ''}
                        ${type === 'berita' ? `
                            <div class="form-group">
                                <label class="form-label">Kategori</label>
                                <select id="beritaCategory" class="form-input">
                                    <option value="Kesehatan">Kesehatan</option>
                                    <option value="Puskesmas">Puskesmas</option>
                                    <option value="Edukasi">Edukasi</option>
                                    <option value="Pengumuman">Pengumuman</option>
                                </select>
                            </div>
                        ` : ''}
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" onclick="closeGalleryModal()">Batal</button>
                        <button class="btn btn-primary" onclick="saveGalleryItem('${type}')">Simpan</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function closeGalleryModal() {
            const modal = document.querySelector('.gallery-modal');
            if (modal) modal.remove();
        }

        function saveGalleryItem(type) {
            const title = document.getElementById('galleryTitle').value;
            const description = document.getElementById('galleryDescription').value;
            const imageFile = document.getElementById('galleryImage').files[0];
            
            if (!title || !description) {
                alert('Judul dan deskripsi harus diisi!');
                return;
            }
            
            const item = {
                id: Date.now(),
                title,
                description,
                image: imageFile ? URL.createObjectURL(imageFile) : '',
                timestamp: new Date().toISOString()
            };
            
            if (type === 'video') {
                item.url = document.getElementById('videoUrl').value;
                item.duration = document.getElementById('videoDuration').value;
            }
            
            if (type === 'berita') {
                item.category = document.getElementById('beritaCategory').value;
            }
            
            // Save to localStorage
            const existingData = JSON.parse(localStorage.getItem(type + 'Data') || '[]');
            existingData.push(item);
            localStorage.setItem(type + 'Data', JSON.stringify(existingData));
            
            // Reload the list
            loadGalleryData(type);
            closeGalleryModal();
            
            alert(`${type.charAt(0).toUpperCase() + type.slice(1)} berhasil ditambahkan!`);
        }

        function editGalleryItem(type, index) {
            // Implementation for editing
            alert(`Edit ${type} - Index: ${index}`);
        }

        function deleteGalleryItem(type, index) {
            if (confirm(`Apakah Anda yakin ingin menghapus ${type} ini?`)) {
                const data = JSON.parse(localStorage.getItem(type + 'Data') || '[]');
                data.splice(index, 1);
                localStorage.setItem(type + 'Data', JSON.stringify(data));
                loadGalleryData(type);
                alert(`${type.charAt(0).toUpperCase() + type.slice(1)} berhasil dihapus!`);
            }
        }

        function addGalleryItem() {
            alert('Fitur tambah foto akan segera tersedia!');
        }

        // Edit/Delete functions
        function editService(id) {
            alert(`Edit layanan dengan ID: ${id}`);
        }

        function deleteService(id) {
            if (confirm('Apakah Anda yakin ingin menghapus layanan ini?')) {
                alert(`Layanan dengan ID ${id} telah dihapus`);
            }
        }

        // Logout function
        function logout() {
            if (confirm('Apakah Anda yakin ingin logout?')) {
                localStorage.removeItem('adminLoggedIn');
                localStorage.removeItem('adminUsername');
                alert('Logout berhasil!');
                window.location.href = '/login';
            }
        }

        // Load dashboard data on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is logged in
            if (localStorage.getItem('adminLoggedIn') !== 'true') {
                alert('Anda harus login terlebih dahulu!');
                window.location.href = '/login';
                return;
            }
            
            // Load dashboard data and settings
            loadDashboardData();
            loadHeroSettings();
            loadPengaduanContent();
            loadGallerySettings();
            loadAboutSettings();
            loadContactSettings();
            loadWebsiteSettings();
            
            // Load gallery data for initial tab
            loadGalleryData('infografis');
        });
    </script>
</body>
</html>
